/* =========================================
 * CopyDesk – module styles
 * - two-lane grid
 * - committed list visuals
 * - card rails + empty slots
 * - delete-row crosshatch
 *
 * Note: style-* text classes are injected from the spreadsheet (authoritative).
 * Keep CopyDesk layout here; keep injected typography/color out of these files.
 * ======================================= */

/* =========================================
 * CopyDesk – module styles
 * (Legacy job header/meta/countdown/segments removed: Copydesk lives inside Ascend shell.)
 * ======================================= */

/* NOTE: #job-name / #job-meta / #job-urgency render inside the Ascend header.
   Do not style them here; keep CopyDesk-only layout/visuals in this file. */

.empty-state {
  font-size: 0.9rem;
  color: var(--ascend-app-text-muted);
  padding: 1rem 0;
}

/* style-* classes are injected by the backend stylesheet (authoritative). */

/* -----------------------------
   CopyDesk – Ascend header overrides
   (Copydesk needs a different header hierarchy than other Ascend apps.)
----------------------------- */

/* Layout: Left = app + job name, Right = meta stack, Far right = Push */
.ascend-app-header {
  display: grid;
  grid-template-columns: 1fr minmax(220px, auto) auto;
  align-items: center;
  gap: 1.25rem;
}

/* Left block: COPYDESK (thin) over Job name (big) */
.ascend-app-title-block {
  display: flex;
  flex-direction: column;
  gap: 0.55rem;
}

.ascend-app-title {
  font-size: 0.95rem;
  letter-spacing: 0.28em;
  text-transform: uppercase;
  opacity: 0.75;
  font-weight: 500;
}

/* Job name should be large, bold, NOT all caps */
#job-name.ascend-app-subtitle {
  font-size: 2.15rem;
  line-height: 1.1;
  font-weight: 750;
  letter-spacing: 0;
  text-transform: none;
  margin: 0;
  color: var(--ascend-app-text, rgba(0,0,0,0.88));
}

/* Right stack: Due date, countdown/job id, collaborators */
.ascend-app-meta {
  display: flex !important;        /* Ascend may hide this by default */
  flex-direction: column;
  align-items: flex-end;
  justify-self: end;
  gap: 0.35rem;
  white-space: nowrap;
  min-width: 220px;
}

#job-urgency {
  font-size: 1.05rem;
  font-weight: 700;
  color: var(--ascend-app-text, rgba(0,0,0,0.88));
}

#job-meta {
  font-size: 0.92rem;
  opacity: 0.72;
  color: var(--ascend-app-text-muted, rgba(0,0,0,0.62));
}

#job-collaborators {
  font-size: 0.95rem;
  opacity: 0.9;
  font-weight: 500;
  color: var(--ascend-app-text, rgba(0,0,0,0.82));
}

/* -----------------------------
   Translation pills (Closed-only)
----------------------------- */
.translation-pills {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  justify-content: flex-end;
  align-items: center;
  max-width: min(520px, 50vw);
}

/* Strong, editorial pill styling (seeded → touched/human → finished)
   Supports both older/newer state class names:
   - pill-seeded / pill-human / pill-touched / pill-finished / pill-archived
   - state-seeded / state-human / state-touched / state-finished / state-archived
*/
.translation-pills {
  --pill-accent: var(--ascend-app-accent, #4fd1c5);
  --pill-ink: rgba(11, 16, 37, 0.94);
  --pill-muted: rgba(11, 16, 37, 0.48);
  --pill-border: rgba(11, 16, 37, 0.16);
}

.translation-pill {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 7px 12px;
  border-radius: 999px;
  border: 1.5px solid var(--pill-border);
  background: rgba(255,255,255,0.92);

  font-size: 13px;
  line-height: 1;
  font-weight: 800;
  letter-spacing: 0.08em;
  text-transform: uppercase;

  color: var(--pill-ink);
  cursor: pointer;
  user-select: none;
  white-space: nowrap;

  transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease, border-color 120ms ease, color 120ms ease, opacity 120ms ease;
}

.translation-pill:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 26px rgba(0,0,0,0.12);
}

/* Disabled = clearly inert */
.translation-pill[aria-disabled="true"] {
  cursor: default;
  opacity: 0.40;
  box-shadow: none !important;
  transform: none !important;
}

/* --- SEEDED (quiet) --- */
.translation-pill.pill-seeded,
.translation-pill.state-seeded,
.translation-pill.pill-archived,
.translation-pill.state-archived {
  background: rgba(255,255,255,0.68);
  border-color: rgba(11, 16, 37, 0.10);
  color: var(--pill-muted);
}

/* --- TOUCHED / HUMAN (half-strength accent) --- */
.translation-pill.pill-human,
.translation-pill.state-human,
.translation-pill.pill-touched,
.translation-pill.state-touched {
  background: rgba(79, 209, 197, 0.22);
  border-color: rgba(79, 209, 197, 0.55);
  color: var(--pill-ink);
  box-shadow: 0 10px 24px rgba(79, 209, 197, 0.16);
}

/* --- FINISHED (full-strength teal + white label) --- */
.translation-pill.pill-finished,
.translation-pill.state-finished {
  /* Deep, confident teal — not terminal black */
  background: rgba(12, 120, 110, 0.96);
  border-color: rgba(79, 209, 197, 0.95);
  color: rgba(255,255,255,0.98);
  box-shadow: 0 14px 30px rgba(12, 120, 110, 0.28);
}

.translation-pill.pill-finished .pill-label,
.translation-pill.state-finished .pill-label {
  color: rgba(255,255,255,0.98);
}

/* Dot = an extra “read” channel */
.translation-pill__dot {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: rgba(0,0,0,0.18);
}

.translation-pill.pill-seeded .translation-pill__dot,
.translation-pill.state-seeded .translation-pill__dot,
.translation-pill.pill-archived .translation-pill__dot,
.translation-pill.state-archived .translation-pill__dot {
  background: rgba(11, 16, 37, 0.22);
}

.translation-pill.pill-human .translation-pill__dot,
.translation-pill.state-human .translation-pill__dot,
.translation-pill.pill-touched .translation-pill__dot,
.translation-pill.state-touched .translation-pill__dot {
  background: rgba(11, 16, 37, 0.78);
}

.translation-pill.pill-finished .translation-pill__dot,
.translation-pill.state-finished .translation-pill__dot {
  background: rgba(255,255,255,0.96);
}

/* Keep Push pinned visually to far right */
.ascend-app-actions {
  display: flex;
  justify-content: flex-end;
}

/* -----------------------------
   CopyDesk content cap + padding rhythm
   (#3: centered, max-width, L/R padding = top padding)
----------------------------- */

.copydesk-content {
  /* Use the same unit for top padding and side padding */
  padding: 16px;

  /* Let the two lanes scale with the panel */
  width: 100%;
  max-width: none;

  margin: 0 auto;
}

/* On very wide screens, keep the background breathing room */
@media (min-width: 1440px) {
  .copydesk-content {
    max-width: none;
    width: 100%;
  }
}

/* Give small screens a bit more comfortable padding */
@media (max-width: 520px) {
  .copydesk-content {
    padding: 14px;
  }
}

/* -----------------------------
   CopyDesk Card Regime layout
----------------------------- */

.copydesk-columns {
  display: grid;
  grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
  gap: 16px;
  align-items: start;
  margin-top: 0;
  width: 100%;
}

.copydesk-col {
  min-width: 0; /* allows lanes to actually flex inside the cap */
  background: linear-gradient(
    180deg,
    rgba(255,255,255,0.72),
    rgba(255,255,255,0.50)
  );
  border: 1px solid var(--ascend-app-border);
  border-radius: 16px;
  padding: 12px 12px 14px;
}

@media (max-width: 860px) {
  .copydesk-columns {
    grid-template-columns: 1fr;
    gap: 14px;
  }
}

.copydesk-col-title {
  font-size: 0.78rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--ascend-app-text-muted, #64748b);
  margin: 0 0 10px 0;
  padding: 0 0 8px 2px;
  border-bottom: 1px solid var(--ascend-app-border);
}

/* -----------------------------
   Committed lane controls
----------------------------- */

.committed-controls {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin: 0 0 0.6rem 0;
}

.committed-add-slot {
  /* visuals come from ascend-apps.css (.ascend-app-panel button) */
  padding: 0.35rem 0.6rem;
  font-size: 0.85rem;
  line-height: 1.1;
}

.committed-add-slot:disabled {
  opacity: 0.45;
  cursor: default;
}

:root {
  /* One authoritative unit height for both lanes */
  --copydesk-unit-h: 220px;
  --copydesk-unit-gap: 0.6rem;
}

.committed-list,
.cards-list {
  display: grid;
  grid-auto-rows: var(--copydesk-unit-h);
  row-gap: var(--copydesk-unit-gap);
}

.committed-seg,
.subjob-english {
  height: auto; /* translation subjob rows size to content */
  box-sizing: border-box;
  border: 1px solid var(--ascend-app-border);
  border-radius: 16px;
  padding: 12px;
  background: rgba(255,255,255,0.92);
  cursor: pointer;

  display: block;

  /* HARD STOP: committed text is ALWAYS single-column */
  columns: auto !important;
  column-count: 1 !important;
  column-width: auto !important;

  overflow: auto;
  word-break: break-word;

  box-shadow:
    0 1px 0 rgba(15, 23, 42, 0.04),
    0 14px 42px rgba(15, 23, 42, 0.08);
}

.committed-list .committed-seg.style-bullet,
.subjob-english.style-bullet {
  display: block !important;
  columns: auto !important;
  column-count: 1 !important;
  column-width: auto !important;

  writing-mode: horizontal-tb !important;

  white-space: pre-wrap !important;
  word-break: normal !important;
  overflow-wrap: break-word !important;
}

.committed-seg:not(.is-divider):hover {
  border-color: color-mix(in srgb, var(--ascend-app-accent) 55%, var(--ascend-app-border) 45%);
}

/* Bullet committed rendering: keep ONE flex child so <br> doesn't become "columns" */
.committed-bullets {
  flex: 1 1 auto;
  min-width: 0;
}

.committed-seg.is-divider {
  /* keep the slot height, but center the divider inside it */
  cursor: default;
  border: none;
  background: transparent;

  display: flex;
  align-items: center;        /* vertical center */
  justify-content: center;    /* horizontal center */

  padding: 0;                 /* no top bias */
  overflow: hidden;           /* prevent scrollbars in divider slots */
  white-space: nowrap;
  user-select: none;

  line-height: 1;             /* tighten baseline “float” */
  letter-spacing: -0.08em;    /* tighter tracking = more “solid” */
  opacity: 0.9;
}

.committed-divider-line {
  height: 1px;
  background: var(--ascend-app-border);
  margin: 0.25rem 0;
}

.committed-divider-label {
  display: none !important; /* No label per spec */
}

/* Translation subjob row alternation (authoritative) */
.subjob-row.is-alt {
  background: rgba(2, 6, 23, 0.025);
}

/* Translation subjob divider rows */
.subjob-row.is-divider {
  border: none;
  background: transparent;
}

.subjob-row.is-divider .subjob-card {
  background: transparent;
  border: none;
  box-shadow: none;
}

.committed-seg.is-marked-delete {
  background-image: repeating-linear-gradient(
    135deg,
    rgba(176, 0, 32, 0.18),
    rgba(176, 0, 32, 0.18) 7px,
    rgba(255, 255, 255, 0.00) 7px,
    rgba(255, 255, 255, 0.00) 14px
  );
  border-color: rgba(176, 0, 32, 0.85);
  box-shadow:
    0 1px 0 rgba(15, 23, 42, 0.04),
    0 14px 38px rgba(176, 0, 32, 0.10);
}

.card-slot {
  height: var(--copydesk-unit-h);
}

.card {
  height: var(--copydesk-unit-h);
  box-sizing: border-box;
  border: 1px solid var(--ascend-app-border);
  border-radius: 16px;
  padding: 12px;
  background: rgba(255,255,255,0.92);

  /* Two-column card: main + right rail */
  display: grid;
  grid-template-columns: 1fr auto;
  column-gap: 0.6rem;
  align-items: stretch;

  box-shadow:
    0 1px 0 rgba(15, 23, 42, 0.04),
    0 14px 42px rgba(15, 23, 42, 0.08);
}

.card-btn {
  /* visuals come from ascend-apps.css (.ascend-app-panel .card-btn) */
  padding: 0.25rem 0.45rem;
  line-height: 1;
}

.card-btn:disabled {
  opacity: 0.45;
  cursor: default;
}

.card-select {
  width: 100%;
  margin: 0.25rem 0 0.45rem 0;
}

.card-textarea {
  width: 100%;
  height: 100%;
  min-height: 0;      /* CRITICAL */
  max-height: 100%;   /* CRITICAL */
  resize: none;       /* prevents “escape the card” resizing */
  overflow: auto;     /* scroll inside */
  line-height: inherit; /* inherit from styled container */

  /* keep containment/layout here; let ascend-apps.css own the “control” visuals */
  box-sizing: border-box;
}

/* -----------------------------
   Headline/Subheadline: one-line (no wrap), horizontal scroll
----------------------------- */
.card-textarea--one-line {
  white-space: nowrap;
  overflow-x: auto;
  overflow-y: hidden;
}

/* -----------------------------
   Card: Bullet
----------------------------- */

.card-preview {
  margin-top: 8px;
  padding: 10px 12px;
  border: 1px solid var(--ascend-app-border);
  border-radius: 12px;
  background: rgba(255,255,255,0.75);
  color: var(--ascend-app-text, rgba(0,0,0,0.86));
  overflow: auto;
  line-height: 1.35;
  font-size: 0.95rem;
}

.card-preview .bullet-glyph {
  opacity: 0.85;
}
/* -----------------------------
   Card: Section Divider editor (line only)
----------------------------- */

.card-divider {
  user-select: none;
  white-space: nowrap;
  opacity: 0.9;
}

/* No visible label/input for divider */
.card-divider-input {
  display: none !important;
}

/* "Delete segment" is an ACTION: there is NO visible text surface in delete mode.
   (JS swaps textarea/divider editor for a hidden [data-role="card-text"] field.) */
.card.is-delete-mark .card-textarea,
.card.is-delete-mark .card-divider,
.card.is-delete-mark .card-divider-input {
  display: none !important;
}

/* Intentionally unused: "Delete segment" is expressed ONLY in the committed lane. */
/* .card.is-delete-row { border-color: #b00020; } */

/* delete-row styling intentionally removed from card textarea */
/* delete intent is expressed ONLY in the committed lane */

.card-main {
  display: grid;
  grid-template-rows: auto 1fr;
  row-gap: 0.45rem;
  min-width: 0;
  min-height: 0; /* CRITICAL: allows textarea row to shrink inside fixed-height card */
}

/* Delete-mode: no editor row, so don't reserve the 1fr “text surface” space. */
.card.is-delete-mark .card-main {
  grid-template-rows: auto auto;
  align-content: start;
}

/* Delete segment: no explanatory text */
.card-delete-note {
  display: none !important;
}

.card-rail {
  display: grid;
  grid-template-rows: auto 1fr auto;
  row-gap: 0.45rem;
  align-items: start;
}

.card-rail-top,
.card-rail-mid,
.card-rail-bot {
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
  align-items: center;
}

/* Rail order: + (inside) above arrow (outside/bottom) */
.card-rail-bot .card-btn[data-role="add-below"] { order: 1; }
.card-rail-bot .card-btn[data-role="move-down"] { order: 2; }

.card-rail-mid {
  justify-content: center;
  align-self: stretch; /* centers trash vertically */
}

/* Optional: make the rail feel like a tool strip */
.card-rail .card-btn {
  padding: 0.25rem 0.35rem;
}

/* Empty slot placeholder card */
.card--empty {
  height: var(--copydesk-unit-h);
  box-sizing: border-box;

  border: 1px dashed color-mix(in srgb, var(--ascend-app-border) 40%, rgba(148, 163, 184, 0.85) 60%);
  border-radius: 16px;
  background:
    repeating-linear-gradient(
      135deg,
      rgba(2, 6, 23, 0.03) 0px,
      rgba(2, 6, 23, 0.03) 10px,
      rgba(2, 6, 23, 0.01) 10px,
      rgba(2, 6, 23, 0.01) 20px
    );
  opacity: 0.9;
  display: grid;
  place-items: center;
  padding: 14px;
}

.card--empty::before {
  content: "";
}

/* Optional: soften when hovering near it */
.card--empty:hover {
  opacity: 1;
  border-color: color-mix(in srgb, var(--ascend-app-accent) 55%, var(--ascend-app-border) 45%);
}

/* Optional: if your layout expects the same grid structure as real cards */
.card--empty .card-main,
.card--empty .card-rail {
  display: none;
}

.status-bar {
  margin-top: 0.75rem;
  font-size: 0.85rem;
  color: var(--ascend-app-text-muted);
}

.status-bar.status-error { color: #b00020; }

/* -----------------------------
   Translation Subjob specifics
----------------------------- */

/* Editable translation inherits committed typography */
.subjob-translation {
  border: none;
  background: transparent;
  padding: 0;
  margin: 0;
  font: inherit;
  color: inherit;
  line-height: inherit;

  /* Allow subjob rows to collapse to content (override subjob.html min-height) */
  min-height: 0;
  height: auto;
  overflow: hidden;

  resize: none;
  outline: none;
}

/* Keep focus subtle */
.subjob-translation:focus {
  outline: none;
  box-shadow: inset 0 0 0 1px rgba(0,0,0,0.08);
  border-radius: 6px;
}

/* -----------------------------
   Closed / Read-only (Bucket B)
----------------------------- */

/* Ribbon banner: absolute so it does NOT reflow the header */
.ascend-app-header {
  position: relative;
}

/* Hidden by default; shown when body.copydesk-is-closed */
#subjob-closed-banner {
  display: none;

  position: absolute;
  top: 0;
  left: 0;
  right: 0;

  padding: 10px 18px;
  border-bottom: 1px solid rgba(110, 64, 0, 0.18);
  border-radius: 0 0 16px 16px;

  background: linear-gradient(90deg,
    rgba(255, 206, 120, 0.42),
    rgba(255, 176, 94, 0.18)
  );

  color: rgba(48, 28, 0, 0.82);
  font-weight: 900;
  letter-spacing: 0.20em;
  text-transform: uppercase;

  pointer-events: none;
}

/* Make room for the ribbon only in closed state */
body.copydesk-is-closed .ascend-app-header {
  padding-top: 64px;
}

/* Remove collaborator identity in closed mode (the email at top-right) */
body.copydesk-is-closed #job-collaborators {
  display: none !important;
}

/* Closed meta replaces Finish in the same slot */
#subjob-closed-meta {
  display: none;

  text-align: right;
  font-size: 12px;
  font-weight: 600;
  color: var(--ascend-app-text-muted);
  letter-spacing: 0.02em;

  white-space: pre-line;
  line-height: 1.2;
}

body.copydesk-is-closed #subjob-finish-btn {
  display: none !important;
}

body.copydesk-is-closed #subjob-closed-meta {
  display: block;
}

body.copydesk-is-closed #subjob-closed-banner {
  display: block;
}